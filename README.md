# 💊 약톡(YakTalk)
LangChain + OpenAI 기반 약물 복용 및 부작용 상담 챗봇  
<br/>

## 📌 프로젝트 개요
약톡(YakTalk)은 600개의 의약품 정보를 기반으로 한 RAG (Retrieval-Augmented Generation) 시스템을 구축하여, 사용자가 약물 복용 중 발생하는 의문사항과 부작용에 대해 즉시 신뢰할 수 있는 상담을 받을 수 있는 대화형 헬스케어 AI 서비스입니다.

**🎯 핵심 가치**
- 즉시성: 24시간 언제든 접근 가능한 AI 상담
- 전문성: 500종 의약품 데이터 기반 신뢰할 수 있는 정보
- 안전성: KTAS 기반 5단계 응급도 평가 및 의도분석 기반 응급 키워드 자동 감지
- 편의성: 자연어 대화를 통한 직관적 상담 경험
<br/>

# 👥 팀 소개
**팀명**: 드럭 스토어 (Drug Store)
**팀원:**
- 👸슬희: [기획 및 시스템 구현] 프로젝트 기획, 시스템 아키텍처 설계 및 구현
- 👸승주: [데이터 엔지니어링 및 AI 모델 최적화] 데이터 수집/전처리, RAG 시스템 및 LLM 성능 최적화
<br/>

## 📂 파일 구성

| 파일명 | 설명 |
| ------ | ------ |
| `medical_rag.py` | RAG 검색 시스템 (FAISS 벡터DB, OpenAI 임베딩) |
| `intent_analyzer.py` | GPT-4 기반 의도 분석 및 응급 키워드 감지 모듈 |
| `emergency_evaluator.py` | KTAS 기반 응급도 평가 시스템 (5단계 위험도 판정) |
| `complete_medical_chatbot.py` | 통합 상담 파이프라인: 의도분석 → 응급평가 → RAG 검색 → 최종 응답 생성 |
<br/>

## ⚙️ 기술 스택

- LangChain: RAG 시스템 구축 및 문서 분할, 체인 관리
- OpenAI GPT-4: 의도 분석 및 자연어 응답 생성
- FAISS: 고속 벡터 유사도 검색 엔진
- OpenAI Embedding: text-embedding-3-small 모델 사용
- Pandas: 의약품 CSV 데이터 로드 및 처리
- hashlib, re: 쿼리 캐싱 및 전처리  
<br/>

## 🧱 시스템 아키텍처
```
사용자 질문
↓
의도 분석 (GPT-4 기반)
↓
응급도 평가 (KTAS 기반 5단계)
↓
RAG 검색 (FAISS + OpenAI Embedding)
↓
LLM 응답 생성 (프롬프트 기반 템플릿 답변)
↓
최종 응답 (위험도에 따른 응답 템플릿)
```

## 📚 데이터 출처

**의약품 정보 데이터베이스**
- 출처: [식품의약품안전처 의약품개요정보(e약은요) 서비스](https://www.data.go.kr/data/15075057/openapi.do)
- 제공기관: 식품의약품안전처
- 데이터 규모: 500개 의약품 상세 정보 (효능·효과, 사용법, 주의사항, 상호작용, 부작용, 보관법)  
<br/>

## 💡 사용 예시

**🚨 응급상황 감지 예시**
```
👤 사용자: "타이레놀 먹고 호흡곤란이 심하고 의식이 흐려져요"

응답:
🚨응급상황 감지
타이레놀 복용 후 호흡곤란과 의식 장애는 심각한 알레르기 반응일 가능성이 있습니다.

🚨 즉시 119 신고하거나 응급실 방문하세요
• 약물 복용 즉시 중단
• 증상 변화 주의 깊게 관찰
```
<br/>

**📌 일반 부작용 예시**
```
👤 사용자: "타이레놀 먹고 속이 아파요"

응답:
👀 경과 관찰
타이레놀 복용 후 속쓰림은 일반적인 위장관 부작용일 수 있습니다.

👀 2-3일 경과 관찰 후 지속되면 병원 방문하세요
• 대부분 시간이 지나면 호전됩니다
```
<br/>

## 🔬 주요 기능 상세

- **의도 분석 (Intent Analyzer):**  
  - GPT-4 기반 프롬프트 분석 + 사전 정의 응급 키워드 rule 기반 보강
  - 질문 유형을 `side_effect`, `usage`, `efficacy`, `other`로 자동 분류
  - 증상 및 응급 키워드 자동 감지

- **응급도 평가 (Emergency Evaluator):**  
  - KTAS 기반 5단계 응급도 분류  
  - 증상 키워드 매칭을 통해 위험도 자동 판단

- **RAG 시스템 (MedicalRAGSystem):**  
  - CSV 데이터 로드 → 문서 분할 → 임베딩 생성 → FAISS 벡터저장소 구축
  - GPT-4 기반 프롬프트 엔지니어링으로 응답 생성

- **통합 파이프라인 (CompleteMedicalChat):**  
  - 의도분석 → 응급도 평가 → 검색 → 응답 → 위험도 템플릿 반영 → 최종 응답 출력
<br/>

## 📝 테스트 스크립트

- `demo_conversation()`: 샘플 5개 질문 자동 테스트 실행
- `quick_test()`: 단일 질문 빠른 테스트
- `test_emergency_evaluation()`: 응급도 평가 유닛테스트
<br/>

## 📊 발표 자료

- [발표 자료 링크](https://drive.google.com/file/d/1rxvm9Cas3rT-ULSCDUQyVDvHkTmTFsY8/view?usp=sharing)
